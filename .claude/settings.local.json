{
  "permissions": {
    "allow": [
      "Skill(code-review)",
      "Skill(code-review:*)",
      "Skill(commit)",
      "Skill(commit:*)",
      "Skill(review-pr)",
      "Skill(review-pr:*)",
      "Bash(git push:*)",
      "Bash(gh pr create --title \"feat: Complete security layer with authentication, rate limiting, and test suite\" --body \"$\\(cat <<''EOF''\n## Summary\n\n- Add complete security layer with authentication, rate limiting, input validation, and attack prevention\n- Add comprehensive test suite with 400+ tests covering all security scenarios\n- Enable Claude Code plugins from marketplace for enhanced development workflow\n- Add hookify rules for automated code quality enforcement\n\n## Changes\n\n### Security Layer\n- Session-based authentication with bcrypt password hashing \\(cost factor 12\\)\n- Rate limiting middleware with configurable limits\n- Input validation using Zod schemas\n- Attack scenario protection \\(XSS, SQL injection, timing attacks\\)\n- Account lockout after 5 failed attempts\n\n### Test Suite\n- `auth.test.ts` - Authentication flow tests\n- `attack-scenarios.test.ts` - Security attack prevention tests\n- `rateLimit.test.ts` - Rate limiting tests\n- `validation.test.ts` - Input validation tests\n- `geminiService.test.ts` - Gemini API integration tests\n- `imageStorage.test.ts` - Image storage tests\n- `transform.test.ts` - Transform endpoint tests\n- `edit.test.ts` - Edit endpoint tests\n- `history.test.ts` - History endpoint tests\n\n### Claude Code Plugins\n- code-review - Multi-agent PR review\n- commit-commands - Streamlined git workflow\n- pr-review-toolkit - Enhanced PR review\n- frontend-design - Distinctive UI design\n- security-guidance - Security pattern monitoring\n\n### Hookify Rules\n- console-log prevention\n- secrets detection\n- eval\\(\\) blocking\n- force push protection\n- dangerous rm warnings\n- test requirements\n- sensitive file protection\n\n## Test plan\n\n- [x] All unit tests pass \\(`npm test`\\)\n- [x] Integration tests pass with PostgreSQL\n- [x] Attack scenario tests verify security\n- [x] Rate limiting tested under load\n- [x] Authentication flow verified\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(gh pr view:*)",
      "Bash(gh pr merge:*)",
      "Bash(git checkout:*)",
      "Bash(git pull:*)",
      "Bash(git ls-tree:*)",
      "Bash(claude mcp:*)",
      "Bash(npm install:*)",
      "Bash(python:*)",
      "Bash(C:UsersavibmAppDataLocalProgramsPythonPython313python.exe -m system_diagnostics_mcp.server --help)",
      "Bash(powershell -Command \"Start-MpScan -ScanType FullScan\")",
      "Bash(powershell -Command:*)",
      "Bash(cleanmgr:*)",
      "Bash(reg query \"HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" /v RingCentral)",
      "Bash(reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run)",
      "Bash(test:*)",
      "Bash(tasklist /FI \"IMAGENAME eq claude.exe\" /V)",
      "Bash(npm test:*)",
      "Bash(npm run:*)",
      "Bash(psql:*)",
      "Bash(tsx scripts/run-migration.ts:*)",
      "Bash(npx tsx:*)",
      "Bash(cat:*)",
      "Bash(docker-compose up:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(npx tsc:*)",
      "Bash(OTEL_ENABLED=false NODE_ENV=development timeout 10 npm run dev:*)",
      "Bash(Select-String -Pattern \"OpenTelemetry|error|Error\" -Context 0,2)",
      "Bash(Select-Object -First 20)",
      "Bash(set OTEL_ENABLED=false)",
      "Bash(Select-String -Pattern \"exports|main\")",
      "Bash(npx vitest run)",
      "Bash(dir:*)",
      "Bash(Select-String \".mjs\")",
      "Bash(ls:*)",
      "Bash(node node_modules/vitest/vitest.mjs run:*)",
      "Bash(npx drizzle-kit push:*)",
      "Bash(node -e:*)",
      "Bash(node:*)",
      "Bash(cmd /c \"rmdir /s /q node_modules\")",
      "Bash(npx rimraf node_modules)",
      "Bash(rimraf:*)",
      "Bash(grep:*)",
      "Bash(npx vitest:*)",
      "Bash(git reset:*)",
      "Bash(tree:*)",
      "Bash(wc:*)",
      "Bash(railway variables:*)",
      "Bash(railway login:*)",
      "Bash(DATABASE_URL=\"postgresql://postgres:VYtUsSExJERzegiSWssGmXHRKqwQzNyq@switchback.proxy.rlwy.net:34192/railway\" npm run db:push:*)",
      "Bash(DATABASE_URL=\"postgresql://postgres:VYtUsSExJERzegiSWssGmXHRKqwQzNyq@switchback.proxy.rlwy.net:34192/railway\" npx tsx -e:*)",
      "Bash(npx task-master-ai:*)",
      "Bash(mkdir:*)",
      "Bash(task-master parse-prd:*)",
      "Bash(findstr:*)",
      "Bash(set GOOGLE_API_KEY=AIzaSyDQ63zIo1JeOYWzinc077npETNwB-evHcI)",
      "Bash(task-master models:*)",
      "Bash(task-master list:*)",
      "Bash(task-master show:*)",
      "Bash(task-master set-status:*)",
      "Bash(DATABASE_URL=\"postgresql://postgres:VYtUsSExJERzegiSWssGmXHRKqwQzNyq@switchback.proxy.rlwy.net:34192/railway\" npx tsx:*)",
      "Bash(DATABASE_URL=\"postgresql://postgres:VYtUsSExJERzegiSWssGmXHRKqwQzNyq@switchback.proxy.rlwy.net:34192/railway\" npx tsx -e \"import pkg from ''pg''; const { Pool } = pkg; const pool = new Pool\\({ connectionString: process.env.DATABASE_URL }\\); const result = await pool.query\\(\"\"SELECT tablename FROM pg_tables WHERE schemaname = ''public''\"\"\\); console.log\\(''Tables:''\\); result.rows.forEach\\(r => console.log\\(''-'', r.tablename\\)\\); await pool.end\\(\\);\")",
      "Bash(DATABASE_URL=\"postgresql://postgres:VYtUsSExJERzegiSWssGmXHRKqwQzNyq@switchback.proxy.rlwy.net:34192/railway\" node -e:*)",
      "Bash(find:*)",
      "Bash(xargs:*)",
      "Bash(gh pr list:*)",
      "Bash(gh pr checkout:*)",
      "Bash(git fetch:*)",
      "Bash(git merge:*)",
      "Bash(git stash:*)",
      "Bash(gh pr close:*)",
      "Bash(railway logs:*)",
      "Bash(npm ls:*)",
      "Bash(cut:*)",
      "Bash(for f in client/src/components/ui/*.tsx)",
      "Bash(do)",
      "Bash(if ! head:*)"
    ]
  }
}
